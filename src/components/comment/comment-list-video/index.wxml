
<view class="comment-wrap">
  
  <!-- 一级评论 -->
  <view class="comment-title-wrap">
    <view class="comment-title">899条评论</view>
    <view class="comment-close-btn">
      <text class="icon-font icondelete" bind:tap="hideCommentPopup"></text>
    </view>
  </view>

  <!-- 弹框内容需要滚动，使用 scroll-view 组件 -->
  <scroll-view scroll-y class="comment-item-wrap">
    <view class="comment-item level-one" wx:for="{{ commentsShow }}" wx:key="{{ item.commentId }}">
      <view class="avatar-one">
        <image src="{{ item.avatar }}" />
      </view>

      <view class="content-one-wrap">
        <view class="content-one-inner">
          <view class="content-nickname">{{ item.nickName }}</view>
          <view class="content-comment" bind:tap="showCommentInputPopup" data-replyto="{{ item }}">
            {{ item.comment }}
            <view class="content-commenttime">12小时前</view>
          </view>
          <view class="comment-star-wrap">
            <text class="icon-font iconheart {{ item.iAlreadyStared ? 'stared' : '' }}" bind:tap="switchStarStatus" data-starto="{{ item }}"></text>
            <view class="comment-star-count {{ item.iAlreadyStared ? 'stared' : '' }}">{{ item.starCount || 0 }}</view>
          </view>
        </view>

        <!-- 二级评论（子评论） -->
        <view 
          class="child-comment-outer" 
          wx:if="{{ item.childComments.length > 0 }}" 
          animation="{{ item.animation }}"
        >
          <view class="child-comment-wrap" data-comment="{{ item }}">
            <view class="comment-item level-two {{ childItem.expandClass || '' }}" wx:for="{{ item.childComments }}" wx:for-item="childItem" wx:key="{{ childItem.commentId }}">
              <view class="avatar-two">
                <image src="{{ childItem.avatar }}" />
              </view>
  
              <view class="content-two-wrap">
                <view class="content-nickname">{{ childItem.nickName }}</view>
                <view class="content-comment" bind:tap="showCommentInputPopup" data-replyto="{{ childItem }}">
                  <block wx:if="{{ childItem.replyTo }}">
                    回复 <text class="content-reply-name" data-replyto="{{ childItem }}">{{ childItem.replyTo.nickName }}</text>：
                  </block>
                  {{ childItem.comment }}
                  <view class="content-commenttime">8小时前</view>
                </view>
                <view class="comment-star-wrap">
                  <text class="icon-font iconheart {{ childItem.iAlreadyStared ? 'stared' : '' }}" bind:tap="switchStarStatus" data-starto="{{ childItem }}"></text>
                  <view class="comment-star-count {{ childItem.iAlreadyStared ? 'stared' : '' }}">{{ childItem.starCount }}</view>
                </view>
              </view>
            </view>
          </view>
        </view>

        <view 
          wx:if="{{ item.childCommentCount > 0 }}" 
          class="comment-more-wrap" 
          bind:tap="getMoreChildComments"
          data-comment="{{ item }}"
        >
          <view class="comment-more-line"></view>
          <text class="comment-more-text">展开131条回复</text>
          <text class="comment-more-icon down"></text>
        </view>
      </view>
    </view>

    <view class="comment-placehold">暂时没有更多了</view>
  </scroll-view>

  <view class="comment-footer-wrap" bind:tap="showCommentInputPopup">
    <view class="comment-footer-inner">
      <text class="comment-footer-text">有爱评论，说点儿好听的～</text>
      <!-- <text class="icon-font iconface"></text> -->
    </view>
  </view>
</view>